<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=GB2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./12.2.4.files/filelist.xml">
<link rel=Edit-Time-Data href="./12.2.4.files/editdata.mso">
<link rel=OLE-Object-Data href="./12.2.4.files/oledata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>主要模块的实现</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>pengwen</o:Author>
  <o:LastAuthor>pengwen</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>566</o:TotalTime>
  <o:Created>2005-09-05T14:18:00Z</o:Created>
  <o:LastSaved>2005-09-05T14:20:00Z</o:LastSaved>
  <o:Pages>14</o:Pages>
  <o:Words>1839</o:Words>
  <o:Characters>10484</o:Characters>
  <o:Company>pengwen</o:Company>
  <o:Lines>87</o:Lines>
  <o:Paragraphs>20</o:Paragraphs>
  <o:CharactersWithSpaces>12875</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:UseFELayout/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimHei;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:楷体_GB2312;
	panose-1:2 1 6 9 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:Univers;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:Arial;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@楷体_GB2312";
	panose-1:2 1 6 9 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
h1
	{mso-style-next:正文;
	margin-top:32.0pt;
	margin-right:0cm;
	margin-bottom:32.0pt;
	margin-left:0cm;
	text-align:center;
	page-break-before:always;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-layout-grid-align:none;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:20.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-next:正文;
	margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:18.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-layout-grid-align:none;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:楷体_GB2312;
	mso-font-kerning:16.0pt;
	font-weight:normal;}
h3
	{mso-style-next:正文;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:173%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:16.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:1.0pt;}
h4
	{mso-style-next:正文;
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:8.5pt;
	margin-left:0cm;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:黑体;
	mso-font-kerning:10.5pt;
	font-weight:normal;}
h5
	{mso-style-next:正文;
	margin-top:16.0pt;
	margin-right:0cm;
	margin-bottom:15.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	mso-layout-grid-align:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:12.0pt;
	mso-bidi-font-weight:normal;}
h6
	{mso-style-next:正文;
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:8.5pt;
	margin-left:0cm;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:楷体_GB2312;
	mso-font-kerning:10.5pt;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:正文;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:0cm;
	line-height:16.0pt;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:7;
	mso-layout-grid-align:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:正文（首行缩进两字）;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:12.0pt;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:8;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-next:正文（首行缩进两字）;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:9.0pt;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:9;
	mso-layout-grid-align:none;
	font-size:7.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	text-transform:uppercase;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:10.5pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	font-variant:small-caps;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	font-style:italic;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:31.5pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:52.5pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:63.0pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:73.5pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{margin:0cm;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:18.0pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-next:正文;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:12.0pt;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	mso-layout-grid-align:none;
	border:none;
	mso-border-bottom-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:0cm 0cm 2.0pt 0cm;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	line-height:12.0pt;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
span.MsoCommentReference
	{mso-ansi-font-size:10.5pt;
	mso-bidi-font-size:10.5pt;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:7.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoBodyTextIndent2, li.MsoBodyTextIndent2, div.MsoBodyTextIndent2
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:7.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	background:navy;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:宋体;
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;}
p.GG, li.GG, div.GG
	{mso-style-name:GG;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:45.25pt;
	margin-bottom:.0001pt;
	text-indent:-21.25pt;
	line-height:16.3pt;
	mso-pagination:none;
	mso-list:l1 level1 lfo1;
	tab-stops:list 45.25pt;
	mso-layout-grid-align:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.--, li.--, div.--
	{mso-style-name:插图--图题;
	mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:none;
	tab-stops:right 241.0pt;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.a, li.a, div.a
	{mso-style-name:表头;
	mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:黑体;}
p.a0, li.a0, div.a0
	{mso-style-name:插图;
	mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:none;
	tab-stops:right dotted 416.75pt;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.--0, li.--0, div.--0
	{mso-style-name:习题--附录;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:19.3pt;
	line-height:14.0pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:9.0pt;}
p.Figure, li.Figure, div.Figure
	{mso-style-name:Figure;
	mso-style-parent:"";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Univers;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-GB;}
p.4, li.4, div.4
	{mso-style-name:索引4;
	mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:黑体;}
p.3, li.3, div.3
	{mso-style-name:索引3;
	mso-style-next:正文;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:12.0pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.40, li.40, div.40
	{mso-style-name:标题4;
	mso-style-next:正文;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	line-height:15.75pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:黑体;}
p.S, li.S, div.S
	{mso-style-name:项目S;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-18.45pt;
	mso-pagination:widow-orphan;
	mso-list:l0 level1 lfo4;
	tab-stops:list 42.55pt;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.a1, li.a1, div.a1
	{mso-style-name:文字框;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:12.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
p.a2, li.a2, div.a2
	{mso-style-name:文框正文;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-header:url("./12.2.4.files/header.htm") h1;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1875119256;
	mso-list-type:simple;
	mso-list-template-ids:-1603621146;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:项目S;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.55pt;
	mso-level-number-position:left;
	margin-left:42.55pt;
	text-indent:-18.45pt;
	font-family:Wingdings;}
@list l1
	{mso-list-id:1911766764;
	mso-list-type:simple;
	mso-list-template-ids:627984824;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:GG;
	mso-level-text:\F026;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	mso-ansi-font-size:12.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<h3 style='margin-top:0cm'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>主要模块的实现</span><span
lang=EN-US style='mso-font-kerning:12.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB1 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⒈</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>智能图案创作</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shapetype id="_x0000_t75" coordsize="21600,21600"
  o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
  stroked="f">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="if lineDrawn pixelLineWidth 0"/>
   <v:f eqn="sum @0 1 0"/>
   <v:f eqn="sum 0 0 @1"/>
   <v:f eqn="prod @2 1 2"/>
   <v:f eqn="prod @3 21600 pixelWidth"/>
   <v:f eqn="prod @3 21600 pixelHeight"/>
   <v:f eqn="sum @0 0 1"/>
   <v:f eqn="prod @6 1 2"/>
   <v:f eqn="prod @7 21600 pixelWidth"/>
   <v:f eqn="sum @8 21600 0"/>
   <v:f eqn="prod @7 21600 pixelHeight"/>
   <v:f eqn="sum @10 21600 0"/>
  </v:formulas>
  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
  <o:lock v:ext="edit" aspectratio="t"/>
 </v:shapetype><v:shape id="_x0000_s1027" type="#_x0000_t75" style='position:absolute;
  left:0;text-align:left;margin-left:39.75pt;margin-top:0;width:279.65pt;
  height:129.35pt;z-index:1' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image001.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1027" DrawAspect="Content" ObjectID="_1187464045">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=53 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=373 height=172 src="./12.2.4.files/image002.gif" v:shapes="_x0000_s1027"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]-->
 <span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图</span><span lang=EN-US>12.41<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>智能图案创作模型</span></span><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>智能图案创作是一个充分体现人类形象思维的</span><span lang=EN-US>CAD</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>领域。不同于其他的</span><span lang=EN-US>CAD</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>领域，如机械</span><span lang=EN-US>CAD</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、电子</span><span lang=EN-US>CAD</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>等，有许多定量的约束存在。图案设计所生成的结果图案除了在某些特定行业中需要满足一定的工艺规格要求</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>如单元尺寸、四方连续等</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>外，在几何布局、色彩选择上都无定量的约束，这也是智能图案</span><span lang=EN-US>CAD</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所要着重解决的问题。一种方法便是利用人的设计知识。传统的图案创作方法认为先生成图案元素，再对图案元素进行各种变形及组合操作，组成子图案，进而形成结果图案。然而人们在创作一幅图案的时候，除临摹外，通常是先有模糊的构思，然后逐步细化，最后定型，在定型的时候才选取图案元素。由此可见，图案创作是一个从一般到特殊的过程。即先有从已知图案归纳得来的构图知识，然后从这些构图知识出发，演绎出新的图案。演绎时以图案所表述的内容为核心，并综合了抽象思维或联想、类比等形象思维甚至灵感思维。可用图</span><span
lang=EN-US>12.41</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示的模型来描述计算机智能图案创作。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=--><span
lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>智能图案创作模型中，选择初始参数的过程就是确定图案内容的过程。系统根据初始参数，从构图知识库中选择初始知识，初始知识可以有若干条。然后，系统根据一定的操作规则对初始知识进行演绎，得到图案点阵。最后，从图案元素库中选取合适的元素插入结果点阵的相应位置，即得到结果图案。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB1 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⒉</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>图像分色</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分色包括四色分色和专色分色，是对原始印制对象的分解。原始印制对象都以图像的形式表现。所以，分色也归结到对图像的分解。一般地，印刷行业通常都采用四色分色，而印花、提花行业往往采用专色分色。但是，在现代的印花工艺中，为了更加逼真地体现水彩画、油画、风景画及人物像片等图案复杂、色彩丰富的花样，也需要采取四色印刷技术来排除印版数目的限制。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑴</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>四色分色</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>色彩学理论认为，颜色是一种波动的光能形式。不同的波长构成了不同的颜色，即光谱。光谱中最重要的颜色是红</span><span
lang=EN-US>(R)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、绿</span><span lang=EN-US>(G)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、蓝</span><span lang=EN-US>(B)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这“三原色”，可见光都由</span><span
lang=EN-US>R</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span><span lang=EN-US>G</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span><span lang=EN-US>B</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>组合而成。在数字印前处理系统中，原始图像是首先表示在显示器上的。对于多数显示器，使用阴极射线管</span><span
lang=EN-US>(CRT)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>产生图像。</span><span lang=EN-US>CRT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>显示器是一种加色系统，即不同的三原色分量</span><span lang=EN-US>R</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span><span lang=EN-US>G</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US>B</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>相叠加形成不同的颜色，如白光是所有可见光的组合，这就是</span><span
lang=EN-US>RGB</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>颜色模型。在印刷或印花工艺上，常用油墨或染料的组合来产生不同的颜色，即从白色开始，减掉被油墨、染料吸收的那部分波长的光，油墨越多，被吸收的光越多，最终的颜色就越暗，这就是所谓的“减色模型”。印刷上常用青</span><span
lang=EN-US>(C)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、品红</span><span lang=EN-US>(M)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、黄</span><span lang=EN-US>(Y)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的组合来产生新颜色。在实践中，为了提高印刷的密度、反差和图像的阶调范围，常增加一套黑版</span><span
lang=EN-US>(K)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，即借助</span><span lang=EN-US>CMYK</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>颜色模型。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1028" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:111.75pt;
  margin-top:0;width:133.8pt;height:83.9pt;z-index:2' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image003.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1028" DrawAspect="Content" ObjectID="_1187464046">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=149 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=178 height=112 src="./12.2.4.files/image004.gif" v:shapes="_x0000_s1028"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]-->
 <span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>图</span><span lang=EN-US>12.42<span
style="mso-spacerun: yes">&nbsp; </span>RGB</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和</span><span
lang=EN-US>CMYK</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的关系</span></span><br
style='mso-ignore:vglayout' clear=ALL>
<span lang=EN-US>RGB</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>颜色模型和</span><span
lang=EN-US>CMYK</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>颜色模型存在一种互补的关系，如图</span><span
lang=EN-US>12.42</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span><span lang=EN-US><o:p></o:p></span>
<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>由此，将所获得的原始图像</span><span lang=EN-US>――</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>以</span><span lang=EN-US>RGB</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>模型表示</span><span
lang=EN-US>――</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>转化为以</span><span lang=EN-US>CMY</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>油墨色表示的分量组合是明显的，可用下式表示：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><sub><span lang=EN-US><!--[if gte vml 1]><v:shape
 id="_x0000_i1027" type="#_x0000_t75" style='width:84.75pt;height:48.75pt'
 o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image005.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=113 height=65
src="./12.2.4.files/image006.gif" v:shapes="_x0000_i1027"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1027"
  DrawAspect="Content" ObjectID="_1187464047">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>而加入黑版</span><span lang=EN-US>(K)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>后，可用如下两种方法确定：</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> GCR(Gray Component Replacement)</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将原始图像中的灰度部分用黑色代替，其余部分再用</span><span
lang=EN-US>CMY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>种颜色复合产生。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> UCR(Under Color Removal)</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将原始图像中的较黑部分用黑色代替，其余部分再用</span><span
lang=EN-US>CMY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>种颜色复合产生。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑵</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>专色分色</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>专色分色处理是将原图像按其色彩属性划分成一定的区域类别，它在模式识别中称为色彩聚类分析，也称分类。经典的聚类方法有最小距离分类法和贝叶斯</span><span
lang=EN-US>(Bayes)</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分类法。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对于印花分色来说，输入的图像数据量十分庞大</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可达几十甚至几百兆字节</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。若直接用以上两种经典的分类方法，随着分色套数的增加，分色速度会愈来愈慢。因此，高质高效地进行分色是非常困难的。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为了解决分色效果与分色速度的兼顾问题，</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统采用了一种基于扫描线的两段法分色模型。其基本思路是，对于同一条扫描线，基于原始印花稿的特殊空间位置关系，在这条扫描线的一段区间</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>领域</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>内的像素点同属于某一套色。给每个套色以一个阈值，把当前点与前一点的距离与前一点所属套色的阈值进行比较，以判断当前点是否与前一点属于同一类别。其主要思想可描述如下。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设第</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>i</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>套色的阈值为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>T<sub>i</sub></span></i><span
lang=EN-US>(<i style='mso-bidi-font-style:normal'>i</i>=0, 1, </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>…</span><span lang=EN-US>, <i style='mso-bidi-font-style:
normal'>N</i></span><span lang=EN-US style='font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>-</span></span><span lang=EN-US>1, </span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>其中</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>N</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为套色数</span><span lang=EN-US>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对每一条扫描线</span><span lang=EN-US>{<i
style='mso-bidi-font-style:normal'>x<sub>j</sub></i>}(<i style='mso-bidi-font-style:
normal'>j</i>=0, 1, </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>…</span><span
lang=EN-US>, M</span><span lang=EN-US style='font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>-</span></span><span lang=EN-US>1, </span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>其中</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>M</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为扫描线长度</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行分类：对于第一个点</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>x</span></i><sub><span lang=EN-US>0</span></sub><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，用经典方法分类，得到点</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>x</span></i><sub><span lang=EN-US>0</span></sub><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所属类别</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>K</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>for(<i
style='mso-bidi-font-style:normal'>i</i> = 1;<i style='mso-bidi-font-style:
normal'>i</i> &lt; <i style='mso-bidi-font-style:normal'>M</i>;<i
style='mso-bidi-font-style:normal'>i</i>++){</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><i style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt'>K</span></i><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&not;</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>x<sub>i</sub></span></i><sub><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>-</span></span></sub><sub><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>1</span></sub><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的类别；</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>求</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>x<sub>i</sub></span></i><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>与类别</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>K</span></i><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的距离</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>d</span></i><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>;</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>if(<i
style='mso-bidi-font-style:normal'>d</i> &lt; <i style='mso-bidi-font-style:
normal'>T<sub>K</sub></i>)</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><i style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt'>x<sub>i</sub></span></i><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>&Icirc;</span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类别</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>K</span></i><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>else</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用经典方法分类</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>x<sub>I</sub></span></i><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>;</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>阈值</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>T<sub>i</sub></span></i><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>可取类别</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>i</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>与其他各类别的距离的最小值：</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><sub><span lang=EN-US><!--[if gte vml 1]><v:shape
 id="_x0000_i1028" type="#_x0000_t75" style='width:152.25pt;height:21.75pt'
 o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image007.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=203 height=29
src="./12.2.4.files/image008.gif" v:shapes="_x0000_i1028"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1028"
  DrawAspect="Content" ObjectID="_1187464048">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:15.75pt;mso-layout-grid-align:none'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>其中，</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>N</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为色彩类别数，</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>d<sub>ij</sub></span></i><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表示类别</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>i</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>与类别</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>j</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的样本距离。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在实际的应用中，阈值也可以乘上一个系数：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><sub><span lang=EN-US><!--[if gte vml 1]><v:shape
 id="_x0000_i1029" type="#_x0000_t75" style='width:89.25pt;height:20.25pt'
 o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image009.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=119 height=27
src="./12.2.4.files/image010.gif" v:shapes="_x0000_i1029"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1029"
  DrawAspect="Content" ObjectID="_1187464049">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>扫描线分色算法的原理可简单说明如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>由算法，有</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>T<sub>i</sub></span></i><span lang=EN-US> </span><span
style='font-family:宋体;mso-hansi-font-family:"Times New Roman"'>≤</span> <i
style='mso-bidi-font-style:normal'><span lang=EN-US>d<sub>ik</sub></span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span><span lang=EN-US><span style="mso-spacerun:
yes">&nbsp; </span><i style='mso-bidi-font-style:normal'>k</i> = 0, 1, </span><span
style='font-family:宋体;mso-hansi-font-family:"Times New Roman"'>…</span><span
lang=EN-US>, <i style='mso-bidi-font-style:normal'>N</i></span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US>1, <i style='mso-bidi-font-style:normal'>k</i></span><span
style='font-family:宋体;mso-hansi-font-family:"Times New Roman"'>≠</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>i</span></i><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:15.75pt;mso-layout-grid-align:none'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对任一点</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>x</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，设它到类别</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>K</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的距离为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>d<sub>xk</sub></span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。若</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>d<sub>xk</sub></span></i><span lang=EN-US> &lt; <i style='mso-bidi-font-style:
normal'>T<sub>i</sub></i></span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，则有</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>d<sub>xk</sub></span></i><span lang=EN-US> &lt; <i style='mso-bidi-font-style:
normal'>d<sub>ik</sub></i></span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span><span
lang=EN-US><span style="mso-spacerun: yes">&nbsp;&nbsp; </span><i
style='mso-bidi-font-style:normal'>i</i> = 0, 1, </span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>…</span><span
lang=EN-US>, <i style='mso-bidi-font-style:normal'>N</i></span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US>1</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>根据最小距离原理，可知</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>x</span></i><span lang=EN-US> </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&Icirc;</span></span><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>类别</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>K</span></i><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB1 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⒊</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>特殊效果处理</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑴</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>喷枪</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1029" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:52.5pt;
  margin-top:0;width:246.15pt;height:369.05pt;z-index:3' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image011.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1029" DrawAspect="Content" ObjectID="_1187464050">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=70 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=328 height=492 src="./12.2.4.files/image012.gif" v:shapes="_x0000_s1029"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]-->
 <span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>图</span><span lang=EN-US>12.43<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>喷枪算法流程图</span></span><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>喷枪模仿喷笔的功能。喷笔的喷量由容量压力和喷笔的大小调节，喷时墨水成散雾状，色块中间浓，并逐渐向四周淡化。</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统中的喷枪采用点子的密度高低和点子本身的大小来控制色块颜色的浓淡，其算法流程如图</span><span
lang=EN-US>12.43</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span><span
lang=EN-US><o:p></o:p></span>
<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑵</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>泥地</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>泥地又称“燥笔”，即模拟设计师用枯笔一扫，产生具有浓淡效果的细点线。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>A</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为区域顶端，</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>AB</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为燥笔的方向线，</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>C</span></i><span lang=EN-US>(<i style='mso-bidi-font-style:normal'>x<sub>C</sub></i>,
<i style='mso-bidi-font-style:normal'>y<sub>C</sub></i>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为区域中的任一点，<i style='mso-bidi-font-style:normal'>θ</i>为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>AB</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>线的倾角，如图</span><span lang=EN-US>12.44</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。则</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>C</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>到</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>AB</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>顶端法向的垂直距离为</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US>|<i style='mso-bidi-font-style:
normal'>x<sub>C</sub></i><sup>*</sup>| = | (<i style='mso-bidi-font-style:normal'>x<sub>C</sub></i>
</span><span lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US> <i style='mso-bidi-font-style:normal'>x<sub>A</sub></i>)</span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&acute;</span></span><span
lang=EN-US>cos</span><i style='mso-bidi-font-style:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>θ</span></i><span lang=EN-US>+ (<i style='mso-bidi-font-style:
normal'>y<sub>C</sub></i> </span><span lang=EN-US style='font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Symbol'><span style='mso-char-type:
symbol;mso-symbol-font-family:Symbol'>-</span></span><span lang=EN-US> <i
style='mso-bidi-font-style:normal'>y<sub>A</sub></i>) </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&acute;</span></span><span
lang=EN-US>sin</span><i style='mso-bidi-font-style:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>θ</span></i><span lang=EN-US>|</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设一条扫描线的两个端点为</span><span lang=EN-US>(<i
style='mso-bidi-font-style:normal'>x</i><sub>1</sub>, <i style='mso-bidi-font-style:
normal'>y</i>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span><span lang=EN-US>(<i
style='mso-bidi-font-style:normal'>x</i><sub>2</sub>, <i style='mso-bidi-font-style:
normal'>y</i>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，且已求得</span><span lang=EN-US>(<i
style='mso-bidi-font-style:normal'>x</i><sub>1</sub>, <i style='mso-bidi-font-style:
normal'>y</i>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>到燥笔顶端法向的距离为</span><span lang=EN-US>|<i
style='mso-bidi-font-style:normal'>x</i><sub>1</sub><sup>*</sup>|</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则扫描线上任一点</span><span lang=EN-US>(<i style='mso-bidi-font-style:
normal'>x</i>, <i style='mso-bidi-font-style:normal'>y</i>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到燥笔顶端法向的距离为</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US>|<i style='mso-bidi-font-style:
normal'>x</i>| = |<i style='mso-bidi-font-style:normal'>x</i><sub>1</sub><sup>*</sup>|
+ |(<i style='mso-bidi-font-style:normal'>x</i> </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US> <i style='mso-bidi-font-style:normal'>x</i><sub>1</sub>)</span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&acute;</span></span><span
lang=EN-US>cos</span><i style='mso-bidi-font-style:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>θ</span></i><span lang=EN-US>|</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一个燥笔泥地的算法描述如下：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>确定燥笔范围及浓淡方向</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>AB</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>沿与方向线垂直的方向，将区域分割成</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>K</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>块，确定各块的阈值</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>T<sub>i</sub></span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>≤</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>i</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>＜</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>K</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>按多边形填色算法，对每一条扫描线，从</span><span
lang=EN-US>(<i style='mso-bidi-font-style:normal'>x</i><sub>1</sub>, <i
style='mso-bidi-font-style:normal'>y</i>)</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>到</span><span
lang=EN-US>(<i style='mso-bidi-font-style:normal'>x</i><sub>2</sub>, <i
style='mso-bidi-font-style:normal'>y</i>)</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作如下处理：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>(a) </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>求</span><span
lang=EN-US>(<i style='mso-bidi-font-style:normal'>x</i><sub>1</sub>, <i
style='mso-bidi-font-style:normal'>y</i>)</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>到区域顶端法向的横坐标</span><span
lang=EN-US>|<i style='mso-bidi-font-style:normal'>x</i><sub>1</sub><sup>*</sup>|</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>(b) </span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>for(<i style='mso-bidi-font-style:normal'>x</i> = <i
style='mso-bidi-font-style:normal'>x</i><sub>1</sub> + <i style='mso-bidi-font-style:
normal'>step</i>;<i style='mso-bidi-font-style:normal'>x</i> &lt; <i
style='mso-bidi-font-style:normal'>x</i><sub>2</sub>;<i style='mso-bidi-font-style:
normal'>x</i> += <i style='mso-bidi-font-style:normal'>step</i>){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><i style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt'>x</span></i><sub><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>1 </span></sub><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Symbol'><span style='mso-char-type:
symbol;mso-symbol-font-family:Symbol'>&not;</span></span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt'> <i style='mso-bidi-font-style:
normal'>x</i><sub>1</sub><sup>*</sup> + <i style='mso-bidi-font-style:normal'>step</i></span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Symbol'><span style='mso-char-type:
symbol;mso-symbol-font-family:Symbol'>&acute;</span></span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>cos</span><i
style='mso-bidi-font-style:normal'><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>θ</span></i><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><i style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt'>d</span></i><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt'> </span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&not;</span></span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'> |<i
style='mso-bidi-font-style:normal'>x</i><sub>1</sub>|</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>根据</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:12.0pt'>d</span></i><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>确定</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
12.0pt'>(<i style='mso-bidi-font-style:normal'>x</i>, <i style='mso-bidi-font-style:
normal'>y</i>)</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是否在区域的第</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>i</span></i><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>块</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>if (<i
style='mso-bidi-font-style:normal'>d</i> &gt; <i style='mso-bidi-font-style:
normal'>T<sub>i</sub></i> )</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:104.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(<i
style='mso-bidi-font-style:normal'>x</i>, <i style='mso-bidi-font-style:normal'>y</i>)</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>处按当前笔画粗细打点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1030" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:97.5pt;
  margin-top:0;width:167.55pt;height:150.95pt;z-index:4' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image013.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1030" DrawAspect="Content" ObjectID="_1187464051">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=130 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=223 height=201 src="./12.2.4.files/image014.gif" v:shapes="_x0000_s1030"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}<span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>图</span><span lang=EN-US>12.44<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>燥笔方向示意图</span><span
lang=EN-US><o:p></o:p></span>
<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑶</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一组撇丝</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在图案创作或重描的过程中常常会用到一组按规律渐变的撇丝，这一组渐变的撇丝在按规律渐变的同时又会随机地在指定的范围内变化，以满足快速便捷的创作要求。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>要产生一组带有随机性的撇丝图案，先由用户通过鼠标勾画出想要产生的一组撇丝的外部轮廓，它是用</span><span
lang=EN-US>B</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>样条曲线来描述的。这样，</span><span lang=EN-US>TOP</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>系统就会根据一组撇丝中预定的参数自动产生一组形状和大小既相关又有随机性的撇丝。具体的算法如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>①用</span><span lang=EN-US>B</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>样条勾画出一组撇丝的外形曲线，存储于</span><span lang=EN-US>FUR_UNIT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这个数据结构中。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>②</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用</span><span
lang=EN-US>RandomPtArray</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数产生一组带有随机性的控制点，存于</span><span
lang=EN-US>FLOWER</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据结构中。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>③</span><span lang=EN-US> for(int i =
0; i &lt; flower.s_count; i++)</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>Ps_00</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数产生一条随机撇丝所需的各个控制点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>④</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>调用</span><span
lang=EN-US>FillFlower</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数在视图或图像中实际画出这一组撇丝。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上述算法中用到的数据结构说明如下。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>typedef
struct{</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>POINT
p_point_start[POINTS_COUNT];</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>count;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>penWidth;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>clrnum;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>mode;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}CURVE;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>每条</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>B</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>样条曲线的信息</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>typedef
struct{</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>CURVE
s[MAXCURVES];</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>s_count;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}FUR_UNIT;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>存放一组撇丝外形轮廓</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>typedef
struct{</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CURVE
s[DETAILPOINTS+1];</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>s_count;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}FLOWER;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>存放每条撇丝的控制点信息</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>实现一组撇丝功能的关键是</span><span lang=EN-US>RandomPtArray</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数的实现。一组撇丝必须有某种程度的形状相似性，同时在用户确定的边界上要和边界保持一致。因此，在实现的过程中采用了旋转方法以保持一组撇丝的形状相似性，但是这样就不能做到同时与两边的边界完全保持一致。在</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统中将两边同时相向进行旋转，两次旋转完成后，再用两个函数进行融合，实际效果还是令人满意的，如图</span><span
lang=EN-US>12.45</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><!--[if gte vml 1]><o:wrapblock><v:shape
  id="_x0000_s1031" type="#_x0000_t75" style='position:absolute;left:0;
  text-align:left;margin-left:101.25pt;margin-top:0;width:160.35pt;height:170.1pt;
  z-index:5' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image015.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1031" DrawAspect="Content" ObjectID="_1187464052">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0 align=left>
  <tr>
   <td width=135 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=214 height=227 src="./12.2.4.files/image016.gif" v:shapes="_x0000_s1031"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>图</span><span lang=EN-US>12.45<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>旋转示意图</span></span><br style='mso-ignore:vglayout' clear=ALL>

<p class=--><span
lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>实现旋转的公式如下。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>x</span></i><sub><span lang=EN-US>1</span></sub><span lang=EN-US> = <i
style='mso-bidi-font-style:normal'>x</i> cos(angle) </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>y</span></i><span
lang=EN-US> sin(angle)</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>y</span></i><sub><span lang=EN-US>1</span></sub><span lang=EN-US> = <i
style='mso-bidi-font-style:normal'>x</i> sin(angle) </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>y</span></i><span
lang=EN-US> cos(angle)</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>旋转变换的正向角度是逆时针方向的，如果是顺时针方向旋转则角度为负。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑷</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>毛毛虫</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>毛毛虫特指这样一种功能：当用户画好一条曲线时，会在这条曲线的一侧自动绘制出用户预先定义的“毛毛虫”，也即任意曲线或规则的图像。这条曲线一侧的毛毛虫的形状、颜色、方向以及每个毛毛虫的间距、大小等参数可由用户指定。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>实现这个功能的关键在于使用了“带角度的点”这种数据结构，</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统中定义为</span><span lang=EN-US>POINT_WITH_ANGLE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，有了这种数据结构，就能确定毛毛虫中各条曲线的坐标轴，从而在正确的方向上绘制出曲线来。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>首先，由用户给出的控制点得到</span><span lang=EN-US>B</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>样条曲线上的各个绘制点，再由各绘制点求出</span><span lang=EN-US>B</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>样条曲线上每一点的切线和法线方向，将切线与</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>x</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>轴的夹角的正切值保存在绘制点的数据结构中。最终自动绘制毛毛虫时，将用户绘制好的毛毛虫按照指定的间距、大小比例因子、旋转角度映射到各绘制点切线、法线确定的坐标系统中来，从而完成绘制过程。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在毛毛虫中用到的几个数据结构如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>typedef
struct{</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>POINT
point;</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>double
angle;</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}POINT_WITH_ANGLE;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>带角度的点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>typedef
struct{</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>POINT_WITH_ANGLE
p_point_start[DETAILPOINTS];</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>count;</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}DETAIL_CURVE;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>带角度点构成的曲线簇信息</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>毛毛虫</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>)</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 5 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑸</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线块创作</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>“线块创作”主要针对一些线条、格子花样而设计。若按照平常的设计方法，花样扫描输入后再重描、修改，设计者的工作量很大，且不易控制线条粗细、线间距大小，更难控制线条的接回头或保证圆网尺寸等。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为了便于处理这类样稿，</span><span lang=EN-US>TOP</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>系统专设线块创作功能模块，将线块样稿图像数据化，软件根据线块数据生成图像。同时，为方便用户的创作，改进人</span><span
lang=EN-US>―</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>机交互界面，用户通过屏幕操作进行改变块大小、线条颜色、块面颜色及块复制、行复制、列复制等操作。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>“线块创作”的设计思路是，首先把线条、格子花样的一个回头进行分解，分成若干小块，对每个小块再分解成线条部分和线条以外的部分</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>称之为“块面”</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。线块创作的基本要素是回头被分解成的最小单元块，用户只需输入这些单元块的大小及线条、块面颜色，线块创作功能即可根据用户指定的数据产生所需花样。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在实际的处理过程中，根据工艺需要，往往简单的创作过程还满足不了要求。要求中包括线块回头的预接，圆网制版中保证圆网回头尺寸，印制过程中的颜色复色、借线，因颜色的深浅关系需作盖版处理，等等。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>a. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>基本线块创作</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线块创作中所操作的基本对象是各个单元小块，单元小块的数据类定义如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>class
CBlock : public CObject</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>{</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>private:</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>double
bk_fWidth;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>宽</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>double
bk_fHeight;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>高</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iBeginX;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>块的始点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(<i
style='mso-bidi-font-style:normal'>x</i></span><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>向</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>)</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iBeginY;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>块的始点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(<i
style='mso-bidi-font-style:normal'>y</i></span><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>向</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>)</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iWidth;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iHeight;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iForeColor;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>前置背景色</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iBackColor;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>后置背景色</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iPenW;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iLineD;</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>int<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bk_iAngle;<span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>//<span
style="mso-spacerun: yes">&nbsp; </span>1:45</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>°</span></span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
12.0pt'>, </span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>1:135</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Symbol'><span style='mso-char-type:
symbol;mso-symbol-font-family:Symbol'>°</span></span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-hansi-font-family:"Times New Roman"'>…</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用户输入一个创作回头的尺寸</span><span lang=EN-US>(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>宽度与高度</span><span lang=EN-US>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，以及水平块数、垂直块数、线宽、线间距等参数。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分别输入水平方向与垂直方向各单元小块的大小尺寸。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分别对每个小块创作，设置其线条颜色及块面颜色，用户可以更改线宽、线间距以及线条的倾斜方向</span><span
lang=EN-US>(45</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>°或</span><span lang=EN-US>135</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>°</span><span lang=EN-US>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>④</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>相同颜色的排列小块之间可以进行单块、横向或纵向复制。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1032" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:88.5pt;
  margin-top:0;width:184.2pt;height:139pt;z-index:6' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image017.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1032" DrawAspect="Content" ObjectID="_1187464053">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=118 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=246 height=185 src="./12.2.4.files/image018.gif" v:shapes="_x0000_s1032"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]-->
 <span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>图</span><span lang=EN-US>12.46<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>接回头示意图</span></span><br
style='mso-ignore:vglayout' clear=ALL>
<span lang=EN-US>b. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>保证线块回头</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span><span
lang=EN-US><o:p></o:p></span>
<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在线块创作中，保证可预接回头是一个非常重要的条件。需进行创作的往往只是一个回头，由于考虑到要保证各小块的尺寸，以及保证线条的光滑，这个回头又不能像其他图样那样进行回头截取。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这里采用的思路是：在其中一个方向上</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>如垂直方向</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，根据垂直回头尺寸大小适当修改“线间距”的大小，使得在整个垂直回头尺寸内，有整数个“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”单元；在另一个方向上</span><span lang=EN-US>(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如水平方向</span><span lang=EN-US>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，根据“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”的大小，适当增加或减少水平回头尺寸，同样使得在整个水平回头尺寸内，有整数个“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”单元。这样，即可保证两个方向的回头预接，如图</span><span
lang=EN-US>12.46</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>下面是算法的描述：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>①</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>由垂直回头尺寸和“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”尺寸计算单元个数，取整后微调“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”大小来设成整数个单元。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>②</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>由“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”尺寸，微调水平回头尺寸，使得在水平回头内有整数个“线宽</span><span
lang=EN-US>+</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>线间距”单元。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>③</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>由以上确定的“水平宽度”、“垂直宽度”、“线宽”、“线间距”进行创作，则达到回头预接。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>c. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>圆网要求</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在印花制版中，其中有许多圆网制版，它要求在圆网尺寸</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>通常是</span><span lang=EN-US>641.0 mm</span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>~</span></span><span
lang=EN-US>642.0 mm</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>之间</span><span
lang=EN-US>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>内，均匀地分布着整数个回头。这样，在线块创作中就必须事先计算回头尺寸，以及各个单元小块的尺寸。在</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统中提供了解决圆网问题的比较方便的方法，具体算法如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>①</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用户按原样大小输入尺寸，以及各个单元小块的尺寸。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>②</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>确定是否是圆网。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>③</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>若是，则确定圆网尺寸，程序自动调整各方向回头尺寸，并按比例缩放各个单元小块。然后，按照调整后的尺寸进行线块创作。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>④</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>否则，按原输入的尺寸数据进行线块创作。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>按以上方法进行线块创作，可以很好地满足圆网要求。但是，某些尺寸无法达到精确值，这样就需要在连晒后，进行局部的微小修改。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>d. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>线块</span><span
lang=EN-US>45</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>°旋转</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在具体的样稿中，通常还存在另外一种线块花样，它是“斜方块、直细条”。为了软件处理上的方便，往往通过“直方块、斜细条”花样的</span><span
lang=EN-US>45</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>°旋转来实现。由于</span><span lang=EN-US>TOP</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>系统中所处理的是线块数据</span><span lang=EN-US>(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>即</span><span lang=EN-US>BLK</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件格式</span><span
lang=EN-US>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而不是图像点阵数据，所以旋转后的图像仍然能保持原有的尺寸和图像质量，而不至失真。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 6 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑹</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>浮雕和雕刻</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指模拟浮雕和雕刻的效果。取像素值的差，并加一个常数</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>比如</span><span lang=EN-US>128)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，图像的平滑区域将被着以中灰色调，而从浅到深像素的转换将产生更亮的线，从深到浅的像素将产生更暗的线。其结果是产生一个有灰色背景的图像，并且黑色和白色线沿着物体的边，这些线靠增加白色亮度和黑色阴影的方法创造了一个有深度的三维视觉效果，这种效果就是浮雕。其算法的主要思想如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>pic(x, y) = pic(x, y)</span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US>pic(x</span><span lang=EN-US style='font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>-</span></span><span lang=EN-US>DeltaX, y</span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US>DeltaY) + 128</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US>(x, y)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是图像中的点，即图像中的每个点等于它和邻近一点的差，再加上常数</span><span
lang=EN-US>128</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。上述公式中用</span><span lang=EN-US>DeltaX</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>DeltaY</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>控制浮雕中的“深度”因素。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>雕刻效果类似于浮雕效果，给人的感觉是光线来自另一个方向</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>好像来自左下角</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。在算法实现上，只要逆转减法的次序就可达到这个效果，即</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>pic(x, y) = pic(x, y) </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US> pic(x+DeltaX, y+DeltaY) + 128</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US>(x, y)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是图像中的点。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 7 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑺</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>霓虹</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>霓虹效果主要用来模拟黑夜中的霓虹效果。它计算相邻像素的“梯度”，即用梯度值来模拟霓虹的效果。其主要的计算公式如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>g1 = (pic(x, y) </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US> pic(x+1, y)) ^ 2</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>g2 = (pic(x, y) </span><span lang=EN-US
style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>-</span></span><span
lang=EN-US>pic(x, y+1)) ^ 2</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>pic(x, y) = percent*sqrt(g1 + g2)</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>由</span><span lang=EN-US>percent</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数控制霓虹的亮度。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 8 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑻</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>马赛克</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>马赛克指用一个正方形区域像素的平均值来替换这个区域，类似于视频中的格子效果。</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统提供马赛克功能的正方形区域的大小可调，最大为</span><span
lang=EN-US>100</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个像素。马赛克效果的算法主要思想是，根据用户设定的正方形区域的大小求出该区域灰度值</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>灰度图像</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或</span><span lang=EN-US>RGB</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>真彩值</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>真彩图像</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的平均值，用这个平均值来填充整个正方形区域，直到整幅图像被填满为止。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 9 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑼</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>油画</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>油画指模拟画家作画的效果，其主要的思想是将图像中的每个点与它周围另一个像素互换，交换是由随机数确定的。当然，为了保证图像不变形和不失真，被交换的像素必须非常接近，</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统中的最大允许值为</span><span lang=EN-US>10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 10 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑽</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>负片</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>负片效果是模拟彩色照片底片的效果，只要逆转图像的颜色即可。显然，图像做两次负片的效果将与原图像一模一样。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 11 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑾</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>亮度和对比度</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以通过调整图像的亮度和对比度来改善灰度或真彩图像的显示效果。图像亮度的调整是一种点运算，处理时对图像中的每个像素加上</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或减去</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一个常数。设像素的亮度为</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>v</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则变换按下式进行：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:17.0pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>v</span></i><span lang=EN-US> = <i style='mso-bidi-font-style:normal'>v</i>
+ <i style='mso-bidi-font-style:normal'>b</i></span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这里</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>b</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是亮度常数，可为正数或负数。如果</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>b</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是正数，则像素亮度增加；如果</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>b</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是负数，则像素亮度减少。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>图像对比度的调整也是一种点运算。一幅图像的对比度与该图像中的亮的部分和暗的部分的分布情况有关。当一幅图像大部分区域都很亮或大部分区域都很暗时，该图像显示出对比度低的特点。而当一幅图像中较亮的部分与较暗的部分所占比重相当时，该图像就显现出对比度高的特点。连续色调的图像只有充分利用了可用的所有灰度色调范围才能显现出对比度高的特点。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以通过对比度拉伸的方法来改善低对比度图像的视觉效果。对比度拉伸时需要先用直方图来判定低对比度图像中像素值的分布主要集中在何区域。一般地，这个区域周围往往有像素值未占用的区域。为了拉伸对比度，需要分别从直方图的左端向右</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>即</span><span lang=EN-US>0</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到</span><span lang=EN-US>255)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和右端向左</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>即</span><span lang=EN-US>255</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到</span><span lang=EN-US>0)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>扫描直方图，分别找到超过给定阈值的第一个像素。小于较低的那个阈值的像素的值置为</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，大于较高的那个阈值的像素的值置为</span><span
lang=EN-US>255</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。界于两个阈值之间的像素，则按比例放大，使其填满</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>到</span><span lang=EN-US>255</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的整个区间。具体的变换公式如下：</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>假设从直方图上找到的两个阈值为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>a</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>b</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，其中</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>a</span></i><span lang=EN-US> &lt; <i
style='mso-bidi-font-style:normal'>b</i></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，则</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:17.0pt;
mso-layout-grid-align:none'><sub><span lang=EN-US><!--[if gte vml 1]><v:shape
 id="_x0000_i1030" type="#_x0000_t75" style='width:267.75pt;height:48.75pt'
 o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image019.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=357 height=65
src="./12.2.4.files/image020.gif" v:shapes="_x0000_i1030"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1030"
  DrawAspect="Content" ObjectID="_1187464055">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoBodyTextIndent style='text-indent:0cm;line-height:17.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>经过上述处理后的图像较好地利用了整个灰度图像，视觉效果明显改善。</span><span lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上述的调整图像亮度和对比度的算法仅适用于灰度图像。对于真彩的图像，可以将它的</span><span
lang=EN-US>RGB</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个通道分别进行上述运算，再将这</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个通道合成真彩图像即可。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 12 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑿</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>灰度</span><span lang=EN-US>/</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>颜色校正</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>灰度</span><span lang=EN-US>/</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>颜色校正主要通过对</span><span lang=EN-US>Gamma</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>值的调整达到改善灰度或真彩图像视觉效果的目的。具体的算法如下：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>假设图像灰度的输入范围为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>in</span></i><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>～</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>in</span></i><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，要求输出的范围为</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>out</span></i><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>～</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>out</span></i><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:17.0pt;
mso-layout-grid-align:none'><sub><span lang=EN-US><!--[if gte vml 1]><v:shape
 id="_x0000_i1031" type="#_x0000_t75" style='width:341.25pt;height:48.75pt'
 o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image021.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=455 height=65
src="./12.2.4.files/image022.gif" v:shapes="_x0000_i1031"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1031"
  DrawAspect="Content" ObjectID="_1187464056">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB1 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⒋</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>工艺处理</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑴</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>挂网处理</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>挂网处理即“电子挂网”，指用一种颜色，凭借点的不同大小和疏密来反映色彩层次的逐渐变化，即“半色调</span><span
lang=EN-US>(Halftone)</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”。在印刷行业，它是四色分色片所必须采用的方法。而在印染业，通常称为“云纹”效果。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>a. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>抖动</span><span
lang=EN-US>(Dither)</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>方法</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>最简单的抖动方法指用一个一定大小的固定阈值的抖动方阵，与原图样进行比较，如果原始图像中像素点的灰度值大于相应抖动矩阵点的值，那么抖动后图像中该点值为亮，否则为暗。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设抖动矩阵</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US style='font-family:黑体;mso-fareast-font-family:宋体'>D</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的大小为</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>m</span></i><span lang=EN-US style='font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>&acute;</span></span><i style='mso-bidi-font-style:normal'><span lang=EN-US>n</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，原始图像中某一点</span><span lang=EN-US>(<i style='mso-bidi-font-style:
normal'>x</i>, <i style='mso-bidi-font-style:normal'>y</i>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的灰度值是</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>I</span></i><span lang=EN-US>(<i style='mso-bidi-font-style:normal'>x</i>,
<i style='mso-bidi-font-style:normal'>y</i>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，那么抖动原理可用下式表达。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>if <i style='mso-bidi-font-style:normal'>I</i>(<i
style='mso-bidi-font-style:normal'>x</i>, <i style='mso-bidi-font-style:normal'>y</i>)
&gt; </span><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='font-family:黑体;mso-fareast-font-family:宋体'>D</span></i><span lang=EN-US>(<i
style='mso-bidi-font-style:normal'>i</i>, <i style='mso-bidi-font-style:normal'>j</i>)</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>PutPixel(<i style='mso-bidi-font-style:normal'>x</i>, <i
style='mso-bidi-font-style:normal'>y</i>, White);</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>else</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>PutPixel(<i style='mso-bidi-font-style:normal'>x</i>, <i
style='mso-bidi-font-style:normal'>y</i>, Black);</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>其中，</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-family:黑体;mso-fareast-font-family:宋体'>D</span></i><span
lang=EN-US>(<i style='mso-bidi-font-style:normal'>i</i>, <i style='mso-bidi-font-style:
normal'>j</i>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是抖动矩阵中与</span><span lang=EN-US>(<i
style='mso-bidi-font-style:normal'>x</i>, <i style='mso-bidi-font-style:normal'>y</i>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对应的点。</span><span lang=EN-US>(<i style='mso-bidi-font-style:
normal'>i</i>, <i style='mso-bidi-font-style:normal'>j</i>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>按下式求得。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:17.0pt;
mso-layout-grid-align:none'><i style='mso-bidi-font-style:normal'><span
lang=EN-US>i</span></i><span lang=EN-US> = <i style='mso-bidi-font-style:normal'>x</i>
mod <i style='mso-bidi-font-style:normal'>m</i></span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>j</span></i><span
lang=EN-US> = <i style='mso-bidi-font-style:normal'>y</i> mod <i
style='mso-bidi-font-style:normal'>n</i></span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>图</span><span lang=EN-US>12.47</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>给出了几个固定阈值的抖动矩阵的例子。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>由于固定阈值的矩阵不能体现每一幅图像的具体细节，因而会产生一些纹路。可寻找一种“自适应”抖动矩阵来解决这个问题。所谓“自适应”，就是能根据图像的细节，自动调整抖动矩阵的值。主要采取以下</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>种策略：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在抖动的同时，检测原图像的边界，一旦检测到边界就改变抖动矩阵。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在抖动的同时，利用已遇见过的图像点灰度等级预测下一小块图像的黑白比，改变抖动矩阵。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>增加抖动矩阵所含的灰度等级，使得抖动后的图像边缘清晰，层次分明。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><sub><span lang=EN-US style='font-size:7.5pt;
mso-bidi-font-size:12.0pt'><!--[if gte vml 1]><v:shape id="_x0000_i1032"
 type="#_x0000_t75" style='width:103.5pt;height:84pt' o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image023.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=138 height=112
src="./12.2.4.files/image024.gif" v:shapes="_x0000_i1032"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.2" ShapeID="_x0000_i1032"
  DrawAspect="Content" ObjectID="_1187464057">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='font-size:7.5pt;
mso-bidi-font-size:12.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><sub><!--[if gte vml 1]><v:shape
 id="_x0000_i1033" type="#_x0000_t75" style='width:99.75pt;height:80.25pt'
 o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image025.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=133 height=107
src="./12.2.4.files/image026.gif" v:shapes="_x0000_i1033"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.2" ShapeID="_x0000_i1033"
  DrawAspect="Content" ObjectID="_1187464058">
 </o:OLEObject>
</xml><![endif]--></span><span lang=EN-US style='font-size:7.5pt;mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US>(a) Lippel</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>抖动矩阵</span><span lang=EN-US><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(b)
Javis</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>抖动矩阵</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><span lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:15.75pt;
mso-layout-grid-align:none'><sub><span lang=EN-US style='font-size:7.5pt;
mso-bidi-font-size:12.0pt'><!--[if gte vml 1]><v:shape id="_x0000_i1034"
 type="#_x0000_t75" style='width:222pt;height:166.5pt' o:ole="" fillcolor="window">
 <v:imagedata src="./12.2.4.files/image027.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=296 height=222
src="./12.2.4.files/image028.gif" v:shapes="_x0000_i1034"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.2" ShapeID="_x0000_i1034"
  DrawAspect="Content" ObjectID="_1187464059">
 </o:OLEObject>
</xml><![endif]--></span></sub><span lang=EN-US style='font-size:7.5pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=--><span lang=EN-US>(c) Bayer</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>抖动矩阵</span><span
lang=EN-US><o:p></o:p></span></p>

<p class=-- style='line-height:17.0pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US>12.47<span style="mso-spacerun: yes">&nbsp; </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>几个固定阈值的抖动矩阵</span><span lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:15.75pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:15.75pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>b. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>拼模法</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>系统的挂网采用拼模法，即采用一种“网点模型”表示不同的灰度等级。针对不同印花机和印刷机的特性，采用不同的网模，如图</span><span
lang=EN-US>12.48</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示。其中，</span><span lang=EN-US>(a)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为滚筒印花网模示例，</span><span lang=EN-US>(b)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为筛网印花和印刷网模示例。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>下面给出挂网算法的主要思想：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>①</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>根据原图像生成挂网分色图和灰度图。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>②</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>读入网模数组，确定挂网颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:17.0pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>③</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>根据挂网分色图、灰度图像完成网模转换并输出图像。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:17.0pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=--><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1033" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:15.75pt;
  margin-top:0;width:315.9pt;height:347.35pt;z-index:7' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image029.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1033" DrawAspect="Content" ObjectID="_1187464060">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=21 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=421 height=463 src="./12.2.4.files/image030.gif" v:shapes="_x0000_s1033"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'><span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span>图</span><span lang=EN-US>12.48<span style="mso-spacerun:
yes">&nbsp; </span></span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>网点模型</span><span
lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑵</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>复色处理</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>纺织印花工艺所采用的是套色印花，一幅图案中的每种套色先后叠印，产生的综合效果即为所需图案。由于印花过程中不可避免的机械误差，因而造成相邻套色之间的错位，产生所谓“露白”现象。工艺上将某种套色区域的边界向另一套色区域扩展一定的大小，使得相邻区域重叠，即“复色”处理。通常是将浅色区域向深色区域扩展，以使重叠部分不会产生明显的第三色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>实现复色处理的原理是，用一个圆沿区域边界进行滚动，以达到均匀复色的效果。圆半径即为复色大小，但还要考虑遇到浅色区域不能复色。算法描述如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>选定要进行复色的套色和复色量，以及较深色和较浅色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用一个</span><span lang=EN-US>3</span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&acute;</span></span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>窗口在图像上移动。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>判断窗口中心的像素是否属于要复色的套色边界。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>④</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>若是，判断要复色的区域内是否有较浅色；若有较浅色，对其屏蔽。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 5 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑤</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>若不是，转</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-begin'></span> = 6 \* GB3 <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>⑥</span><!--[if supportFields]><span lang=EN-US><span
style='mso-element:field-end'></span></span><![endif]--><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 6 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑥</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>以中心像素点为圆心画圆，半径为复色量的大小，屏蔽点不处理，并保存结果。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 7 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑦</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>转至</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-begin'></span> = 2 \* GB3 <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>②</span><!--[if supportFields]><span lang=EN-US><span
style='mso-element:field-end'></span></span><![endif]--><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>重复操作，直至结束。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑶</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>间丝处理</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>系统中，间丝处理的功能有手动间丝、自动间丝、浮长检测等多种间丝方法。在此着重分析自动间丝的算法实现。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>自动间丝任务：在图样上的某平涂色块上按照选定的组织规律着间丝点。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输入：需间丝的色块色号。浮长</span><span lang=EN-US>(fuchang)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>规定大于此浮长的色块才进行间丝。离间数</span><span lang=EN-US>(lijian)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>要求间丝点离色块边缘必须大于离间数。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输出</span> <span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：已被着上间丝点的图像。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据结构：</span><span lang=EN-US>c0[width]</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>存放间丝前的一行图像，</span><span lang=EN-US>c1[width]</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>存放间丝后的一行图像，</span><span lang=EN-US>check[width]</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是辅助数组。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1034" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:47.25pt;
  margin-top:0;width:262.75pt;height:81pt;z-index:8' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image031.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1034" DrawAspect="Content" ObjectID="_1187464061">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=63 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=350 height=108 src="./12.2.4.files/image032.gif" v:shapes="_x0000_s1034"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]-->
 <span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>图</span><span lang=EN-US>12.49<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>自动间丝中数据结构的相互关系</span></span><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>算法思路：设置辅助数组</span><span lang=EN-US>check[] </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，数组大小为图像宽度。根据原图像上的每一行数据</span><span lang=EN-US>c0[]</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，设置</span><span lang=EN-US>check[] </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据，使得其对应关系如图</span><span lang=EN-US>12.49</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span><span
lang=EN-US><o:p></o:p></span>
<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这样，只有在</span><span lang=EN-US>check[]</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数组中</span><span lang=EN-US> count&gt;fuchang</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，且元素值大于离间数</span><span lang=EN-US>(lijian)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的点上才可能点间丝，其余各点均保留原色。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>C</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语言算法描述如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>for(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>每一行图像</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>读取该行图像到</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>c0[]</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，根据</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>c0[]</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>计算</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>check[]</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>for(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>该行图像上的每一点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>if(check[i]
&gt;lijian )</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:104.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>根据组织确定覆盖间丝点</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>else</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:104.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>c1[i]
= c0[i];</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑷</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>勾边处理</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>a. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>自动块勾边</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>算法中采取移动窗口的方式，统计该窗口中待勾边颜色的比例，确定该窗口对应的意匠图区域的最终颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>算法描述如下：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>确定勾边针数</span><i style='mso-bidi-font-style:
normal'><span lang=EN-US>m</span></i><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，梭数</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>n</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，将窗口大小设置为</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>m</span></i><span lang=EN-US style='font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:
Symbol'>&acute;</span></span><i style='mso-bidi-font-style:normal'><span lang=EN-US>n</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>确定需勾边的颜色</span><span lang=EN-US>
gb_color</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在意匠图起点处，取一窗口大小色块。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>④</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>判断窗口中是否含有需勾边颜色</span><span lang=EN-US>
gb_color</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，若没有，转⑥。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 5 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑤</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计该色块中</span><span lang=EN-US>gb_color</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是否过半。若是，将色块都置为</span><span lang=EN-US> gb_color</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>；否则，统计所有在该色块中出现的颜色比例，将该色块置成具有最高统计比例的那种颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 6 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑥</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>判断窗口是否已遍历了意匠图。若是，转⑦；否则，移动窗口到下一个位置，转④。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 7 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑦</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结束。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US>b. </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>平纹勾边</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>平纹勾边起始于单起点或双起点上，以后的横直格过渡均为奇数格。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>算法采用了</span><span lang=EN-US>3</span><span
lang=EN-US style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>&acute;</span></span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的窗口包围每一个图像点，然后根据中心像素点的属性分</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>种情况分别讨论：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中心点是单起点，且颜色为需处理的颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中心点是双起点，且颜色为需处理的颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中心点是单起点，且颜色不是需处理的颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>④</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中心点是双起点，且颜色不是需处理的颜色。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输入待勾边的色号。确定是单起平纹勾边，还是双起平纹勾边。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对算法分析可知，设图像宽度为</span><i
style='mso-bidi-font-style:normal'><span lang=EN-US>m</span></i><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，高度为</span><i style='mso-bidi-font-style:normal'><span
lang=EN-US>n</span></i><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则算法的时间复杂度为</span><span lang=EN-US>9<i
style='mso-bidi-font-style:normal'>mn</i></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，空间复杂度为</span><span
lang=EN-US>3<i style='mso-bidi-font-style:normal'>m</i></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，有待改进。</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 5 \* GB2 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑸</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>纹板输出</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一幅意匠图只有在变换成纹板后才能控制织机织出像意匠图所示图案的织物来。即使是电子提花织机，意匠图也需变换成电子纹板信息后才能控制织机上的提花针动作。因此，</span><span
lang=EN-US>TOP</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统首先将意匠图信息变换成纹板信息。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在织造过程中，每个梭子对应着一张纹板。根据织造工艺，每个意匠横格对应着一定数量的纹板，而每个纵格则对应着一张纹板上一定数量的孔，这些孔称作纹针孔。另外，每张纹板上的某些孔起着辅助织机工作的作用，称作辅助针孔。对应于龙头上的辅助针，常用的辅助针有穿线孔、边针、棒刀针等，而纹板上纹针及辅助针的排列次序由样卡确定。在纹板变换中，意匠图中的每一色块都按一定的组织变换成相应纹板上的纹针孔信息，即轧孔或不轧孔，而各种辅助针也存在各自的变换规律。在纹板变换时，系统将意匠图上的一行信息根据预先建立的轧孔组织资料</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>组织库及色号组织对应关系</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和样卡资料变换成纹板信息，存入纹板数据文件。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1035" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:51.75pt;
  margin-top:0;width:259.85pt;height:113.9pt;z-index:9' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image033.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1035" DrawAspect="Content" ObjectID="_1187464062">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout'>
 <table cellpadding=0 cellspacing=0>
  <tr>
   <td width=69 height=0></td>
  </tr>
  <tr>
   <td></td>
   <td><img width=346 height=152 src="./12.2.4.files/image034.gif" v:shapes="_x0000_s1035"></td>
  </tr>
 </table>
 </span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]-->
 <span class="--"><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>图</span><span lang=EN-US>12.50<span
style="mso-spacerun: yes">&nbsp; </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>纹板变换原理图</span><span
lang=EN-US><o:p></o:p></span></span><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>纹板变换原理如图</span><span lang=EN-US>12.50</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span><span
lang=EN-US><o:p></o:p></span>
<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>纹板输出的过程算法描述如下：</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 1 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>①</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输入纹板的造数、重数。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 2 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>②</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>建立组织色号的对应关系。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 3 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>③</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>产生纹板的各种要素的有效性检查，若无效，转⑧。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 4 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>④</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>显示将要建立的纹板信息，包括样卡、重造数、抛道等，待用户确定是否继续。若不继续，转⑧。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 5 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑤</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>建立组织</span><span lang=EN-US>(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或意匠、多造、抛道等</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>纹板。</span><span lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 6 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑥</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>显示纹板，待用户检查纹板的正确性之后，确定是否保存纹板。若不保存，转⑧。</span><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 7 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑦</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>保存纹板。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><!--[if supportFields]><span lang=EN-US><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes">&nbsp;</span>= 8 \* GB3 <span style='mso-element:
field-separator'></span></span><![endif]--><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>⑧</span><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-end'></span></span><![endif]--><span
lang=EN-US> </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>返回。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>建立纹板时有多种方式，包括组织纹板、多造纹板、意匠纹板、抛道纹板等。这些建立方式中，其主要算法思想大致相同。纹板建立的算法程序框图如图</span><span
lang=EN-US>12.51</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示。</span><span lang=EN-US
style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:15.75pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:15.75pt;mso-layout-grid-align:none'><span
lang=EN-US style='mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=--><!--[if gte vml 1]><o:wrapblock><v:shape id="_x0000_s1036" type="#_x0000_t75"
  style='position:absolute;left:0;text-align:left;margin-left:-3pt;
  margin-top:0;width:367.3pt;height:404.95pt;z-index:10' o:allowincell="f">
  <v:imagedata src="./12.2.4.files/image035.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![if gte mso 9]><o:OLEObject Type="Embed" ProgID="Photoshop.Image.5"
  ShapeID="_x0000_s1036" DrawAspect="Content" ObjectID="_1187464063">
 </o:OLEObject>
 <![endif]><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
 relative;z-index:9;left:-4px;top:0px;width:490px;height:540px'><img width=490
 height=540 src="./12.2.4.files/image036.gif" v:shapes="_x0000_s1036"></span><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span><span lang=EN-US>12.51<span style="mso-spacerun:
yes">&nbsp; </span></span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>纹板建立的算法程序框图</span><span
lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>程序的</span><span lang=EN-US>C</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语言算法描述如下：</span><span lang=EN-US style='mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图像的每一行</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>for(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>每一重</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>for(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>样卡上的每一个位置</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(col, row)){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>if(</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>样卡上</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(col, row)</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>孔位为无用针</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>)</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:104.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>纹板上</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(col, row)</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>置</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>0</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>else
if ( </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>样卡上</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>(col, row)</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>孔位是实用纹针</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>){</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:125.85pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>纹针坐标变换及查表组织处理；</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:125.85pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>if (</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>轧孔</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>)</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:146.85pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>纹板上</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'> (col, row) </span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>置</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>1</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:125.85pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>else </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:146.85pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>纹板上</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'> (col, row) </span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>置</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>0</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>else
{/* </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>孔位是辅助针</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>*/</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:104.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>辅助针查表变换；</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:104.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>同上道理，视不同情况置</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>1</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或置</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>0</span><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:83.9pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:62.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:41.95pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:15.75pt;mso-layout-grid-align:
none'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:12.0pt'>}</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><a href="12.2.3.htm">&lt;&lt;</a></span><a href="12.2.3.htm"><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上一节</span></a><span
lang=EN-US>&nbsp;<span style="mso-spacerun: yes">&nbsp; </span><a href="12.2.htm">12.2</a>&nbsp; <span
style="mso-spacerun: yes">&nbsp;</span><a href="12.2.2.htm">12.2.2</a>&nbsp;<span style="mso-spacerun:
yes">&nbsp; </span><a href="12.2.3.htm">12.2.3</a></span></p>

</div>

</body>

</html>
